/**
* Simple Notification
* https://github.com/Glagan/SimpleNotification
*/
class SimpleNotification{constructor(a){this.node=void 0,this.wrapper=void 0,this.title=void 0,this.closeButton=void 0,this.body=void 0,this.image=void 0,this.text=void 0,this.buttons=void 0,this.progressBar=void 0,this.duration=0,this.fadeoutTime=0,this.events={},Object.keys(a).forEach(b=>{this.events[b]=a[b]}),this.addExtinguish=this.addExtinguishFct.bind(this),this.removeExtinguish=this.removeExtinguishFct.bind(this)}static options(a){SimpleNotification.default=Object.assign({},SimpleNotification.default,a)}static makeWrapper(a){let b=document.createDocumentFragment(),c=document.createElement("div");c.className="gn-wrapper gn-"+a,b.appendChild(c),document.body.appendChild(b),SimpleNotification.wrappers[a]=c}static firstUnbreakChar(a,b,c=0){0>c&&(c=0);let d;for(;0<=c;)d=a.indexOf(b,c),c=0<d&&"\\"==a[d-1]?d+1:-1;return d}static searchToken(a,b,c){let d=[c[0],c[1]];for(let e=a.length;d[0]<e;d[0]++){if("string"==typeof a[d[0]]&&-1<(d[1]=a[d[0]].indexOf(b,d[1])))return d;d[1]=0}return[-1,-1]}static breakString(a,b,d,e){let f={open:b.open.length,close:b.close.length};if(d[0]!=e[0]){let g={tag:b,str:[a[d[0]].substring(d[1])]},h=0;for(let b=d[0]+1;b<e[0];b++,h++)g.str.push(a[b]);return g.str.push(a[e[0]].substring(0,e[1])),g.str=[this.joinString(g.str)],a.splice(d[0]+1,h,g),e[0]=d[0]+2,a[d[0]]=a[d[0]].substring(0,d[1]-f.open),a[e[0]]=a[e[0]].substring(e[1]+f.close),[e[0],0]}return a.splice(d[0]+1,0,{tag:b,str:[a[d[0]].substring(d[1],e[1])]},a[d[0]].substring(e[1]+f.close)),a[d[0]]=a[d[0]].substring(0,d[1]-f.open),[d[0]+2,0]}static joinString(a){let b=[];for(let c=0,d=a.length;c<d;c++)"string"==typeof a[c]?b.push(a[c]):(b.push(a[c].tag.open),b.push(this.joinString(a[c].str)),b.push(a[c].tag.close));return b.join("")}static buildNode(a,b){for(let c=0;c<a.length;c++)if("string"==typeof a[c])0<a[c].length&&b.appendChild(document.createTextNode(a[c]));else{let d=a[c].tag,e=document.createElement(d.type);("a"==d.type||"button"==d.type)&&e.addEventListener("click",a=>{a.stopPropagation()});let f,g=this.joinString(a[c].str);if("title"in d&&d.title&&0<g.length)if(0==g.indexOf("!"))g=g.substring(1);else{let a=this.firstUnbreakChar(g,"|");g=g.replace("\\|","|"),-1<a&&(f=g.substring(0,a),g=g.substring(a+1))}if(null==f&&(f=g),"attributes"in d&&Object.keys(d.attributes).forEach(a=>{let b=d.attributes[a].replace("$content",g).replace("$title",f);e.setAttribute(a,b)}),"textContent"in d&&d.textContent?e.textContent=d.textContent.replace("$content",g).replace("$title",f):this.textToNode(a[c].str,e),d.class)if(Array.isArray(d.class))for(let a=0,b=d.class.length;a<b;a++)e.classList.add(d.class[a]);else e.className=d.class;b.appendChild(e)}return b}static textToNode(a,b){if(null==a)return;let c;Array.isArray(a)?c=a:(a=a.replace(/(\r?\n|\r)/gm,"\n"),c=[a]),(this.tokens==null||this.refreshTokens!=null)&&(this.tokens=Object.keys(SimpleNotification.tags),this.refreshTokens=void 0);for(let d=0,e=this.tokens.length;d<e;d++){let a=SimpleNotification.tags[this.tokens[d]],b={open:a.open.length,close:a.close.length},e=[0,0],f=[0,0],g=[0,0];for(;-1<(f=this.searchToken(c,a.open,e))[0];)f[1]+=b.open,e=-1<(g=this.searchToken(c,a.close,f))[0]?this.breakString(c,a,f,g):f}return this.buildNode(c,b)}make(a){this.node=document.createElement("div"),this.node.className="gn-notification gn-insert",a.forEach(a=>{this.node.classList.add(a)}),this.node.addEventListener("animationend",a=>{"fadeout"==a.animationName?this.close(!1):("insert-left"==a.animationName||"insert-right"==a.animationName)&&this.node.classList.remove("gn-insert")}),this.events.onCreate&&this.events.onCreate(this)}setType(a){if(this.node){let b=this.node.classList.contains("gn-close-on-click");this.node.className=["gn-notification gn-",a].join(""),b&&this.node.classList.add("gn-close-on-click")}}setDuration(a){this.duration=a}setFadeoutTime(a){this.fadeoutTime=a}setPosition(a){a in SimpleNotification.wrappers||SimpleNotification.makeWrapper(a),this.wrapper=SimpleNotification.wrappers[a],this.node&&this.wrapper.appendChild(this.node)}addCloseOnClick(){this.node.title="Click to close.",this.node.classList.add("gn-close-on-click"),this.node.addEventListener("click",()=>{this.close(!0)})}addStartStop(){this.node.addEventListener("mouseenter",this.removeExtinguish),this.node.addEventListener("mouseleave",this.addExtinguish)}setTitle(a){this.title==null&&(this.title=document.createElement("h1"),this.node.insertBefore(this.title,this.node.firstElementChild),this.closeButton&&this.title.appendChild(this.closeButton)),this.title.title=a,this.title.textContent=a}addCloseButton(){let a=document.createElement("span");a.title="Click to close.",a.className="gn-close",a.textContent="\u274C",a.addEventListener("click",()=>{this.close(!0)}),this.title?(a.classList.add("gn-close-title"),this.title.appendChild(a)):this.node.insertBefore(a,this.node.firstElementChild)}addBody(){this.body=document.createElement("div"),this.body.className="gn-content",this.node.appendChild(this.body),this.buttons?this.node.insertBefore(this.body,this.buttons):this.progressBar?this.node.insertBefore(this.body,this.progressBar):this.node.appendChild(this.body)}setImage(a){this.image==null&&(this.image=document.createElement("img"),this.text?this.body.insertBefore(this.image,this.text):this.body.appendChild(this.image)),this.image.src=a}setText(a){if(this.text==null)this.text=document.createElement("div"),this.text.className="gn-text",this.body.appendChild(this.text);else for(;this.text.firstChild;)this.text.removeChild(this.text.firstChild);SimpleNotification.textToNode(a,this.text)}addButton(a,b,c){this.buttons==null&&(this.buttons=document.createElement("div"),this.buttons.className="gn-buttons",this.progressBar?this.node.insertBefore(this.buttons,this.progressBar):this.node.appendChild(this.buttons));let d=document.createElement("button");SimpleNotification.textToNode(b,d),d.className=["gn-button gn-",a].join(""),c&&d.addEventListener("click",a=>{a.stopPropagation(),c(this)}),this.buttons.appendChild(d)}removeButtons(){this.buttons&&(this.node.removeChild(this.buttons),this.buttons=void 0)}addProgressBar(){this.progressBar=document.createElement("span"),this.progressBar.className="gn-lifespan";let a=b=>{"shorten"==b.animationName&&(this.progressBar.removeEventListener("animationend",a),this.progressBar.classList.add("gn-retire"),this.events.onDeath?this.events.onDeath(this):(this.disableButtons(),this.closeFadeout()))};this.progressBar.addEventListener("animationend",a);let b=a=>{if("insert-left"==a.animationName||"insert-right"==a.animationName){if(this.progressBar.style.animationDuration=[this.duration,"ms"].join(""),document.hasFocus())this.progressBar.classList.add("gn-extinguish");else{let a=()=>{this.progressBar.classList.add("gn-extinguish"),document.removeEventListener("focus",a)};document.addEventListener("focus",a)}this.node.removeEventListener("animationend",b)}};this.node.addEventListener("animationend",b),this.node.appendChild(this.progressBar)}display(){this.node&&(this.wrapper.appendChild(this.node),this.events.onDisplay&&this.events.onDisplay(this))}remove(){return null!=this.node&&(this.node.remove(),this.node=void 0,!0)}close(a){this.remove()&&this.events.onClose&&this.events.onClose(this,a)}addExtinguishFct(){this.progressBar.classList.add("gn-extinguish")}removeExtinguishFct(){this.progressBar.classList.remove("gn-extinguish")}disableButtons(){if(this.buttons)for(let a=0,b=this.buttons.childNodes.length;a<b;a++)this.buttons.childNodes[a].disabled=!0}closeFadeout(){this.node.removeEventListener("mouseenter",this.removeExtinguish),this.node.removeEventListener("mouseleave",this.addExtinguish),this.node.style.animationDuration=[this.fadeoutTime,"ms"].join(""),this.node.classList.add("gn-fadeout"),this.node.addEventListener("mouseenter",a=>{a.target.classList.remove("gn-fadeout")}),this.node.addEventListener("mouseleave",a=>{a.target.classList.add("gn-fadeout")})}static create(a,b,c={}){let d="image"in b&&b.image,e="text"in b&&b.text,f="title"in b&&b.title,g="buttons"in b;if(d||f||e||g){let h=Object.assign({},SimpleNotification.default,c);h.closeButton=!h.closeOnClick&&h.sticky||h.closeButton;let j=new SimpleNotification(h.events);if(j.make(a),j.setDuration(h.duration),j.setFadeoutTime(h.fadeout),j.setPosition(h.position),h.closeOnClick&&j.addCloseOnClick(),h.sticky||j.addStartStop(),f&&j.setTitle(b.title),h.closeButton&&j.addCloseButton(),(d||e)&&(j.addBody(),d&&j.setImage(b.image),e&&j.setText(b.text)),g){Array.isArray(b.buttons)||(b.buttons=[b.buttons]);for(let a=0,c=b.buttons.length;a<c;a++)j.addButton(b.buttons[a].type,b.buttons[a].value,b.buttons[a].onClick)}return h.sticky||j.addProgressBar(),(!("display"in h)||h.display)&&j.display(),j}}static success(a,b={}){return this.create(["gn-success"],a,b)}static info(a,b={}){return this.create(["gn-info"],a,b)}static error(a,b={}){return this.create(["gn-error"],a,b)}static warning(a,b={}){return this.create(["gn-warning"],a,b)}static message(a,b={}){return this.create(["gn-message"],a,b)}static custom(a,b,c={}){return this.create(a,b,c)}static addTag(a,b){this.tags[a]=b,this.refreshTokens=!0}}SimpleNotification.wrappers={},SimpleNotification.default={position:"top-right",closeOnClick:!0,closeButton:!0,duration:4e3,fadeout:400,sticky:!1,events:{onCreate:void 0,onDisplay:void 0,onDeath:void 0,onClose:void 0}},SimpleNotification.tags={code:{type:"code",class:"gn-code",open:"``",close:"``",textContent:"$content"},header2:{type:"h2",class:"gn-header",open:"## ",close:"\n"},header1:{type:"h1",class:"gn-header",open:"# ",close:"\n"},image:{type:"img",title:!0,attributes:{src:"$content",title:"$title"},textContent:!1,open:"![",close:"]"},link:{type:"a",title:!0,attributes:{href:"$content",target:"blank",title:"$title"},textContent:"$title",open:"{{",close:"}}"},bold:{type:"span",class:"gn-bold",open:"**",close:"**"},italic:{type:"span",class:"gn-italic",open:"*",close:"*"},separator:{type:"div",class:"gn-separator",textContent:!1,open:"\n---\n",close:""},linejump:{type:"br",textContent:!1,open:"\n",close:""}};